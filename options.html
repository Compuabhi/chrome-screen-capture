<!--
 * Copyright (c) 2009 The Chromium Authors. All rights reserved.  Use of this
 * source code is governed by a BSD-style license that can be found in the
 * LICENSE file.
-->
<html>
 <head>
  <title> Screen Capture Options </title>
  <style>
  body {
    font-family: arial, sans-serif;
    margin:10px;
    background: #EBEFF9;
    font-size: 13px;
  }
  #header {
    padding-bottom:1em;
    padding-top:1em;
  }
  #header h1 {
    font-size: 30px;
    display: inline;
    color: #3d5d6a;
    padding-bottom: 40px;
    padding-left: 90px;
    padding-top: 70px;
    background: url(icon_48.png) no-repeat;
    background-position: 1px 62px;
  }
  h4 {
    padding-left: 0.5em;
    border-bottom: 2px dotted #c3c3c3;
    color: #333333;
    line-height: 28px;
    font-size: 15px;
  }
  p {
    padding-left: 2em;
    font-family: verdana, arial, sans-serif, simsun;
    font-size: 14px;
  }
  .section-header {
    background: #ebeff9;
    border-top: 1px solid #b5c7de;
    font-size: 99%;
    padding: 3px 0 2px 5px;
    font-weight: bold;
    margin-bottom: 1em;
    margin-top: 1em;
  }
  .contentBox {
    background-color: #ffffff;
    border: 3px solid #bec9ce;
    border-bottom-left-radius: 20px 20px;
    border-bottom-right-radius: 20px 20px;
    border-top-left-radius: 20px 20px;
    border-top-right-radius: 20px 20px;
    padding: 30px;
    text-align: left;
    margin: 50px auto 20px auto;
    width: 600px;
  }
  .section-content {
    padding-left: 80px;
    line-height: 25px;
  }
  .colorBox {
    width: 60px;
    height: 20px;
    margin: 3px 0 0 2px;
  }
  #colorpad {
    position: absolute;
    word-wrap: break-word;
    word-break: normal;
    z-index: 10;
    border: #000000 solid 1px;
    background-color: #ffffff;
    padding: 5px;
    width: 393px;
  }
  #colorpad a {
    margin: 2px;
    padding: 1px;
    display: block;
    height: 20px;
    width: 20px;
    float: left;
    border: 1px solid #333333;
  }
  .contentLeft {
    float: left;
    width: 100px;
    line-height: 28px;
  }
  .contentRight {
    float: left;
  }
  .clear {
    clear: both;
  }
  .section-content {
    padding-left: 55px;
  }
  .closeBtn {
    margin: 20px 0 0 0;
  }
  #footer {
    text-align: center;
    font-size: 13px;
  }
  </style>
  <script>
  var bg = chrome.extension.getBackgroundPage();

  function init() {
    i18nReplace('optionTitle', 'optionTitle');
    i18nReplace('saveAndClose', 'saveAndClose');
    i18nReplace('screenshootQualitySetting', 'screenshootQualitySetting');
    i18nReplace('lossyScreenShot', 'lossyScreenShot');
    i18nReplace('losslessScreenShot', 'losslessScreenShot');
    i18nReplace('autoSaveText', 'autoSave');
    i18nReplace('setSavePath', 'setSavePath');
    i18nReplace('openSavePath', 'openSavePath');
    i18nReplace('autoSaveSetting', 'autoSaveSetting');
    i18nReplace('defaultPath', 'defaultPath');
    document.getElementById('autoSave').checked = eval(localStorage.autoSave);
    document.getElementById('filePath').value = localStorage.savePath =
        localStorage.savePath ? localStorage.savePath : getDefaultSavePath(); 
    document.getElementById('setSavePath').addEventListener('click', function() {
      var savePath = setSavePath();
      document.getElementById('filePath').value = localStorage.savePath = savePath;
    });
    document.getElementById('openSavePath').addEventListener('click', function() {
      bg.screenshot.openSavePath();
    })
    initScreenCaptureQuality();
  }

  function save() {
     localStorage.screenshootQuality =
         document.getElementById('lossy').checked ? 'jpeg' : '' ||
         document.getElementById('lossless').checked ? 'png' : '';
     localStorage.autoSave = document.getElementById('autoSave').checked ?
         'true' : 'false';
  }

  function saveAndClose() {
    save();
    chrome.tabs.getSelected(null, function(tab) {
      chrome.tabs.remove(tab.id);
    });
  }

  function initScreenCaptureQuality() {
    bg.screenshot.setScreenshotQualityByOS();
    document.getElementById('lossy').checked =
        (localStorage.screenshootQuality == 'jpeg' ? true : false);
    document.getElementById('lossless').checked =
        (localStorage.screenshootQuality == 'png' ? true : false);
  }

  function setSavePath() {
    var pluginobj = document.getElementById('pluginobj');
    return pluginobj.SetSavePath(localStorage.savePath);
  }

  function getDefaultSavePath() {
    var pluginobj = document.getElementById('pluginobj');
    return pluginobj.GetDefaultSavePath();
  }

  function i18nReplace(id, name) {
    return document.getElementById(id).innerText = chrome.i18n.getMessage(name);
  }

  </script>
 </head>
 <body onload="init();">

 <div class="contentBox">
   <div id="header">
     <h1 id="optionTitle"></h1>
   </div>
   <h4 id="screenshootQualitySetting"></h4>
   <div class="section-content">
     <div>
       <label></label><input id="lossy" type="radio" name="quality"><span id="lossyScreenShot"></span></label>
       &nbsp; <label></label><input id="lossless" type="radio" name="quality"><span id="losslessScreenShot"></span></label>
     </div>
     <div class="clear"></div>
   </div>
   <h4 id="autoSaveSetting"></h4>
   <div class="section-content">
     <div class="clear"></div>
     <div id="defaultPath"></div>
     <div ><input type="text" id="filePath" disabled="true" size="40">
       <button id="setSavePath"></button>
       <button id="openSavePath"></button>
     </div>
     <div style="margin:5px 0 0 10px;"><label><input type="checkbox" id="autoSave"><span id="autoSaveText"></span></label></div>
     <div class="clear"></div>
   </div>
   <div class="closeBtn"><button id="saveAndClose" onclick="saveAndClose()"></button></div>
 </div>


 </div>
 <div id="footer">&copy;2010 Google</div>
 <embed id="pluginobj" width="0" height="0" type="application/x-screencapture" />
 </body>
</html>
